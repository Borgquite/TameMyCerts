TameMyCerts is a policy module for Microsoft Active Directory Certificate Services (AD CS) enterprise certification authorities that enables security automation for a lot of use cases in the PKI field.

The module supports, amongst other functions, inspecting certificate requests for certificate templates that allow the subject information to be specified by the enrollee against a defined policy. If any of the requested identities violates the defined rules, the certificate request automatically gets denied by the certification authority. Requested identities can also be mapped against Active Directory to apply restrictions based on group memberships, or even to pull certificate content from AD.

The module therefore helps you to tame your certs! It has proven itself in countless environments of enterprise-grade scale.

TameMyCerts is Open Source Software. Find it on [GitHub](https://github.com/Sleepw4lker/TameMyCerts).

> **Commercial support** and **maintenance agreements** are available on demand. [Contact me](https://www.gradenegger.eu/en/imprint/) for details if you are interested.

## Table of content

- [What is TameMyCerts and why would I need it?](#why)

    - [How TameMyCerts can secure mobile device deployments with Microsoft Intune and similar MDM systems](#uc-dsmapping)

    - [How TameMyCerts can help establish digital signature processes in the enterprise](#uc-subjectdn)

    - [How TameMyCerts can repair incoming certificate requests to make them RFC-compliant](#uc-supplement-dns)

    - [How TameMyCerts can stop attacks against the ESC6 vector](#uc-esc6)

- [How TameMyCerts works](#how-it-works)

- [Prerequisites](#prerequisites)

- [Installing the TameMyCerts policy module](#installing)

    - [Upgrading from a previous version](#upgrading)

    - [Uninstalling the TameMyCerts policy module](#uninstalling)

- [Configuring the TameMyCerts policy module](#configuring)

    - [Global settings](#global-settings)

    - [Audit only mode](#audit-only-mode)

    - [Configuring rules for the key pair of a CSR](#key-rules)

    - [Configuring rules to restrict cryptographic providers creating a CSR](#csp-rules)

    - [Configuring rules to restrict processes creating a CSR](#process-rules)

    - [Configuring rules for the Subject Distinguished Name of a CSR](#subject-rules)

    - [Configuring rules for Subject Alternative Names of a CSR](#san-rules)

    - [Supplementing DNS names and IP addresses](#supplement-dns-names)

    - [Configuring a fixed expiration date for all issued certificates](#enddate)

    - [Configuring directory services mapping](#ds-mapping)

    - [Configuring directory object rules](#ds-object-rules)

    - [Working with the SID certificate extension](#sid-extension)

    - [Modifying the Subject Distinguished Name with static values](#modify-subject-dn-static)

    - [Modifying the Subject Distinguished Name with values from Active Directory](#modify-subject-dn)

    - [Modifying the Subject Alternative Name with static values](#modify-san-static)

    - [Modifying the Subject Alternative Name with values from Active Directory](#modify-san)

    - [Supplementing Service Principal Names from mapped Active Directory objects](#supplement-spns)

    - [Configuring per-template CDP, AIA or OCSP URIs](#cdp-aia-ocsp)

    - [Issuing Certificates with an exactly defined validity period](#startdate)

    - [Permitting empty identities](#empty-identities)

    - [Denying certificate requests for insecure combinations](#deny-insecure-flags)

- [Monitoring and Troubleshooting](#troubleshooting)

    - [Error codes](#error-codes)

    - [Caches involved](#caches)

    - [Known limitations, common issues and frequently asked questions](#limitations)

- [Logs generated by the TameMyCerts policy module](#logs)

- Technical reference

    - [Description of the "Pattern" directive](#pattern)

    - [Description of the "DirectoryServicesAttribute" directive](#ds-attribute)